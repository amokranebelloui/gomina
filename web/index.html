<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Hello World</title>
    <script src="lib/react.js"></script>
    <script src="lib/react-dom.js"></script>
    <script src="lib/babel.min.js"></script>
    <script type="text/babel" src="components/gomina.js"></script>
    <script type="text/babel" src="components/layout.js"></script>

    <script src="https://unpkg.com/prop-types/prop-types.js"></script>

</head>
<body>
<div id="root"></div>
<script type="text/babel">

    function Clock1(props) {
        return (
            <span>
                <b>It's {props.date.toLocaleTimeString()}.</b>
            </span>
        )
    }

    class MyComponent extends React.Component {
        render() {
            let text = "'" + this.props.label + "'";
            if (this.props.highlighted) {
                text = <b> {text} </b>;
            }
            return (
                <span>Special {text}</span>
            )
        }
    }
    MyComponent.propTypes = {
        label: PropTypes.string.isRequired,
        highlighted: PropTypes.bool
    };

    class Toggle2 extends React.Component {
        constructor(props) {
            super(props);
            this.state = {isToggleOn: true};
            this.toggle = this.toggle.bind(this); // This binding is necessary to make `this` work in the callback
        }
        toggle() {
             this.setState(prevState => ({
                isToggleOn: !prevState.isToggleOn
             }));
        }
        render() {
            return (
                <button onClick={this.toggle}>
                    {this.state.isToggleOn ? 'ON' : 'OFF'}
                </button>
            );
        }
    }

    class LoggingButton extends React.Component {

        handleClick() {
            console.log('this is:', this);
        }

        render() {
            return (
                    <button onClick={e => this.handleClick(e)}>
                        Click me
                    </button>
            );
        }
    }

    function WarningBanner(props) {
        if (!props.warn) {
            return null;
        }

        return (
                <div className="warning">
                    Warning! {props.warn}
                </div>
        );
    }



    const posts = [
        {id: 1, title: 'Hello World 4', content: 'Welcome to learning React!'},
        {id: 2, title: 'Installation', content: 'You can install React from npm.'},
        {id: 3, title: 'Live Edit in Jetbrains, wo', content: 'You can live edit from Jetbrains IDE, wow!'}
    ];

    class Posts extends React.Component {
        constructor(props) {
            super(props);
            //this.state = {logged: false, user: "amo"}
        }
        render() {
            return (
                <ul>
                    {this.props.posts.map((post) =>
                        <li key={post.id}>{post.title}</li>
                    )}
                </ul>
            )
        }
    }

    class App extends React.Component {
        constructor(props) {
            super(props);
            this.state = {logged: true, user: "amo"}
        }
        render() {
            let status;
            if (this.state.logged) {
                status = <span>Hello '{this.state.user}'</span>
            }
            else {
                status = <span>Hi buddy</span>
            }
            return (
                <AppLayout title='Sandbox'>
                    <span>{status}</span>&nbsp;
                    {this.state.logged && <Clock />}
                    <br/>

                    Linked toggles
                    <Toggle toggled={this.state.logged} onToggleChanged={e => {this.setState({logged: e})}} />
                    <Toggle toggled={this.state.logged} onToggleChanged={e => {this.setState({logged: e})}} />
                    <br/>
                    Independent <Toggle2 />
                    <LoggingButton/>
                    <WarningBanner warn="Something happened" />
                    <WarningBanner warn="" />
                    <br/>
                    <Posts posts={this.props.posts} />
                    <MyComponent label="hello world" highlighted={true} />
                    <MyComponent label="hello world" />
                </AppLayout>
            );
        }
    }

    ReactDOM.render(<App posts={posts}/>, document.getElementById('root'));

</script>

</body>
</html>
