<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Projects</title>
    <script src="lib/react.js"></script>
    <script src="lib/react-dom.js"></script>
    <script src="lib/babel.min.js"></script>
    <script type="text/babel" src="data.js"></script>
    <script type="text/babel" src="gomina.js"></script>
</head>
<body>
<div id="root"></div>

<script type="text/babel">

    class LinesOfCode extends React.Component {
        render() {
            const base = {padding: '2px', borderRadius: '3px', display: 'block'};
            const high = {width: 110, backgroundColor: 'black', color: 'white'};
            const medium = {width: 80, backgroundColor: 'gray', color: 'white'};
            const low = {width: 50, backgroundColor: 'lightgray', color: 'white'};
            const unknown = {width: 110, backgroundColor: '#FFEEEE', color: 'gray'};

            const loc = this.props.loc;
            const style = loc > 10000 ? high : loc > 5000 ? medium : loc > 0 ? low : unknown;
            return (
                <span style={{display: 'inline-block', width: 114, backgroundColor: '#E8E8E8', borderRadius: '3px'}}>
                    <span style={Object.assign(base, style)}>{loc || 'Unknown'}</span>
                </span>
            );
        }
    }

    class Coverage extends React.Component {
        render() {
            const base = {padding: '2px', borderRadius: '3px', display: 'block'};
            const high = {width: 110, backgroundColor: 'green', color: 'white'};
            const medium = {width: 80, backgroundColor: 'orange', color: 'white'};
            const low = {width: 50, backgroundColor: 'red', color: 'white'};
            const unknown= {width: 50, backgroundColor: '#lightgray', color: 'gray'};

            const coverage = this.props.coverage;
            const style = coverage > 20 ? high : coverage > 8 ? medium : coverage > 0 ? low : unknown;
            return (
                <span style={{display: 'inline-block', width: 114, backgroundColor: '#E8E8E8', borderRadius: '3px'}}>
                    <span style={{float: 'right', color: '#BBBBBB', fontSize: 10}}>
                        (22/24)
                    </span>
                    <span style={Object.assign(base, style)}>
                        {coverage ? coverage + ' %' : 'Unknown'}
                    </span>
                </span>
            );
        }
    }

    class BuildLink extends React.Component {
        render() {
            return (
                <a href={this.props.url} target="_blank" title={this.props.url}
                   style={{backgroundColor: '#E8BD30', color: 'white', padding: 2, borderRadius: '3px', fontSize: 10}}>
                    build
                </a>
            )
        }
    }

    class ScmLink extends React.Component {
        render() {
            const changesCount = this.props.changes;
            const hasChanges = changesCount > 0;
            const backgroundColor = hasChanges ? '#EAA910' : '#F2E18F';
            return (
                    <a href={this.props.url} title={'svn url: ' + this.props.url}
                       style={{backgroundColor: backgroundColor, color: 'white', padding: 2, borderRadius: '3px', fontSize: 10}}>
                       {hasChanges ? 'svn (' + changesCount + ' chg)' : 'svn'}
                    </a>
            )
        }
    }

    class ProjectSummary extends React.Component {
        render() {
            const project = this.props.project;
            return (
                <Well block margin="0 0 2px 0">
                    <div style={{display: 'block', verticalAlign: 'top', overflow:'auto'}}>
                        <div style={{display: 'block', float: 'left', marginRight: 2}}>
                            <span title={project.id}>
                                <b>{project.label}</b>
                                <span style={{fontSize: 10, marginLeft: 2}}>({project.type})</span>
                            </span>
                            <br/>
                            <span style={{fontSize: 11}}>{project.mvn}</span>
                        </div>
                        <div style={{display: 'block', float: 'right', verticalAlign: 'top'}}>
                            <LinesOfCode loc={project.loc} />&nbsp;
                            <Coverage coverage={project.coverage} />&nbsp;
                        </div>
                        <div style={{display: 'block'}}>
                            <BuildLink url={project.jenkins} /> (Build status)&nbsp;
                            <ScmLink url={project.svn} changes={project.changes} />&nbsp;
                            <Version version={project.released} />&nbsp;
                            <Version version={project.latest} />
                        </div>

                    </div>
                </Well>
            )
        }
    }

    class App extends React.Component {
        render() {
            const projects = allProjects;
            return (
                    <div>
                        <Menu /><br/>
                        Projects
                        <br/>
                        {projects.map(project =>
                            <ProjectSummary key={project.id} project={project} />
                        )}
                    </div>
            );
        }
    }

    ReactDOM.render(<App />, document.getElementById('root'));

</script>

</body>
</html>